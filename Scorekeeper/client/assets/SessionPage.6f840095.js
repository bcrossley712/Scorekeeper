import{k as F,u as E,g as C,j as H,D as G,c as _,a as m,o,b as r,d as c,l as u,t as j,F as g,B,e as t,s as n,z as h}from"./vendor.bbfce40b.js";import{_ as D,A as s,p as b,h as I,g as N,l as S,P as d}from"./index.2fec108f.js";import{s as f}from"./SessionsService.df937d66.js";const V={setup(){const v=F(),a=E(),l=C({});return H(()=>{l.value=s.activeSession}),G(async()=>{try{s.activeSession=await f.getSessionById(v.params.id),await b.getSessionsPlayers(v.params.id),await I.getSessionsHands(v.params.id),await N.getGames()}catch(e){S.error(e),d.toast(e.message,"error")}s.activeGame=s.games.find(e=>e.id==s.activeSession.gameId)}),{players:_(()=>s.players),game:_(()=>s.activeGame),user:_(()=>s.user),session:_(()=>s.activeSession),async addPlayer(){try{b.addPlayer(v.params.id)}catch(e){S.error(e),d.toast(e.message,"error")}},async archiveSession(){var e;try{((e=s.activeSession)==null?void 0:e.archived)==!1?await d.confirm("Archive Session and declare winner?","","info","Go for it!")&&(l.value.archived=!s.activeSession.archived,f.archiveSession(l.value),a.push({name:"Game",params:{id:s.activeSession.gameId}})):await d.confirm("Remove from archive and allow editing?","","info","Yes, please.")&&(l.value.archived=!s.activeSession.archived,f.archiveSession(l.value))}catch(p){S.error(p),d.toast(p.message,"error")}},async deleteSession(){try{await d.confirm("Delete Session?")&&(a.push({name:"Game",params:{id:s.activeSession.gameId}}),await f.deleteSession(s.activeSession.id),d.toast("Session deleted","success"))}catch(e){S.error(e),d.toast(e.message,"error")}}}}},M={class:"session container-fluid"},R={class:"row"},z={class:"col-12 d-flex justify-content-between p-2"},L={key:0,class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#player-add"},T={key:1},Y={class:"text-center"},q={key:2},J={class:"row"},K=h("Add Player"),O=h("Edit Player?"),Q=h("Add Hand"),U=h("Edit Hand?");function W(v,a,l,e,p,X){const w=m("Player"),P=m("PlayerAddForm"),y=m("Modal"),A=m("PlayerEditForm"),k=m("HandAddForm"),x=m("HandEditForm");return o(),r(g,null,[c("div",M,[c("div",R,[c("div",z,[e.session.archived==!1&&e.user.isAuthenticated?(o(),r("button",L," Add Player ")):e.user.isAuthenticated?(o(),r("div",T)):u("",!0),c("div",Y,[c("h2",null,j(e.game.title),1)]),e.session.archived==!1&&e.user.isAuthenticated?(o(),r("div",q,[e.players.length>0?(o(),r("button",{key:0,class:"btn btn-warning",onClick:a[0]||(a[0]=(...i)=>e.archiveSession&&e.archiveSession(...i))}," Complete session? ")):u("",!0),c("i",{class:"mdi mdi-delete text-danger selectable ms-2",title:"Delete session",onClick:a[1]||(a[1]=(...i)=>e.deleteSession&&e.deleteSession(...i))})])):e.user.isAuthenticated?(o(),r("i",{key:3,class:"mdi mdi-pencil text-warning selectable",title:"Edit Session",onClick:a[2]||(a[2]=(...i)=>e.archiveSession&&e.archiveSession(...i))})):u("",!0)])]),c("div",J,[(o(!0),r(g,null,B(e.players,i=>(o(),r("div",{class:"col-6 col-sm-4 col-md-2",key:i.id},[t(w,{player:i},null,8,["player"])]))),128))])]),t(y,{id:"player-add"},{title:n(()=>[K]),body:n(()=>[t(P)]),_:1}),t(y,{id:"player-edit"},{title:n(()=>[O]),body:n(()=>[t(A)]),_:1}),t(y,{id:"add-hand"},{title:n(()=>[Q]),body:n(()=>[t(k)]),_:1}),t(y,{id:"edit-hand"},{title:n(()=>[U]),body:n(()=>[t(x)]),_:1})],64)}var se=D(V,[["render",W]]);export{se as default};
