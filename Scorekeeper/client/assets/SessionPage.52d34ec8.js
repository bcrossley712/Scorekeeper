import{k as F,u as E,g as C,j as H,D as G,c as f,a as m,o as d,b as c,d as i,l as g,t as j,F as u,B,e as t,s as r,z as _}from"./vendor.bbfce40b.js";import{_ as D,A as s,p as b,h as I,g as N,l as h,P as n}from"./index.74f11a8d.js";import{s as S}from"./SessionsService.8140dc36.js";const V={setup(){const v=F(),a=E(),l=C({});return H(()=>{l.value=s.activeSession}),G(async()=>{try{s.activeSession=await S.getSessionById(v.params.id),await b.getSessionsPlayers(v.params.id),await I.getSessionsHands(v.params.id),await N.getGames()}catch(e){h.error(e),n.toast(e.message,"error")}s.activeGame=s.games.find(e=>e.id==s.activeSession.gameId)}),{players:f(()=>s.players),game:f(()=>s.activeGame),session:f(()=>s.activeSession),async addPlayer(){try{b.addPlayer(v.params.id)}catch(e){h.error(e),n.toast(e.message,"error")}},async archiveSession(){var e;try{((e=s.activeSession)==null?void 0:e.archived)==!1?await n.confirm("Archive Session and declare winner?","","info","Go for it!")&&(l.value.archived=!s.activeSession.archived,S.archiveSession(l.value),a.push({name:"Game",params:{id:s.activeSession.gameId}})):await n.confirm("Remove from archive and allow editing?","","info","Yes, please.")&&(l.value.archived=!s.activeSession.archived,S.archiveSession(l.value))}catch(p){h.error(p),n.toast(p.message,"error")}},async deleteSession(){try{await n.confirm("Delete Session?")&&(a.push({name:"Game",params:{id:s.activeSession.gameId}}),await S.deleteSession(s.activeSession.id),n.toast("Session deleted","success"))}catch(e){h.error(e),n.toast(e.message,"error")}}}}},M={class:"session container-fluid"},R={class:"row"},z={class:"col-12 d-flex justify-content-between p-2"},L={key:0,class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#player-add"},T=i("div",{class:"v-else"},null,-1),Y={class:"text-center"},q={key:1},J={class:"row"},K=_("Add Player"),O=_("Edit Player?"),Q=_("Add Hand"),U=_("Edit Hand?");function W(v,a,l,e,p,X){const w=m("Player"),P=m("PlayerAddForm"),y=m("Modal"),k=m("PlayerEditForm"),x=m("HandAddForm"),A=m("HandEditForm");return d(),c(u,null,[i("div",M,[i("div",R,[i("div",z,[e.session.archived==!1?(d(),c("button",L," Add Player ")):g("",!0),T,i("div",Y,[i("h2",null,j(e.game.title),1)]),e.session.archived==!1?(d(),c("div",q,[e.players.length>0?(d(),c("button",{key:0,class:"btn btn-warning",onClick:a[0]||(a[0]=(...o)=>e.archiveSession&&e.archiveSession(...o))}," Complete session? ")):g("",!0),i("i",{class:"mdi mdi-delete text-danger selectable ms-2",title:"Delete session",onClick:a[1]||(a[1]=(...o)=>e.deleteSession&&e.deleteSession(...o))})])):(d(),c("i",{key:2,class:"mdi mdi-pencil text-warning selectable",title:"Edit Session",onClick:a[2]||(a[2]=(...o)=>e.archiveSession&&e.archiveSession(...o))}))])]),i("div",J,[(d(!0),c(u,null,B(e.players,o=>(d(),c("div",{class:"col-6 col-sm-4 col-md-2",key:o.id},[t(w,{player:o},null,8,["player"])]))),128))])]),t(y,{id:"player-add"},{title:r(()=>[K]),body:r(()=>[t(P)]),_:1}),t(y,{id:"player-edit"},{title:r(()=>[O]),body:r(()=>[t(k)]),_:1}),t(y,{id:"add-hand"},{title:r(()=>[Q]),body:r(()=>[t(x)]),_:1}),t(y,{id:"edit-hand"},{title:r(()=>[U]),body:r(()=>[t(A)]),_:1})],64)}var se=D(V,[["render",W]]);export{se as default};
